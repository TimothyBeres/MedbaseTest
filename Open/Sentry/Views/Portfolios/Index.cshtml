@using iTextSharp.text
@using Open.Domain.Product
@using Open.Facade.Product
@model Open.Facade.Product.PortfolioViewModel
@{
    ViewData["Title"] = "Index";

    var listOfObjects = Model.MedicinesInUse;
    var rowsCount = listOfObjects.Count / 3; ;
    if (rowsCount % 3 != 0 || listOfObjects.Count < 3)
    {
        rowsCount += 1;
    }
    var cellsRemaining = listOfObjects.Count;
    //Layout = "_Layout";
    MedicineViewModel medView =new MedicineViewModel();
    medView.Name = "HEI";
}


<style type="text/css">
    .button1 {
        background-color: white; /* Green */
        color: black; 
        border: 2px solid #f44336;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        -webkit-transition-duration: 0.4s; /* Safari */
        transition-duration: 0.4s;
        cursor: pointer;
        border-radius: 8px;
    }
    .button1:hover {
        background-color: #f44336;
        color: white;
    }
</style>
<script src="~/lib/jquery/dist/jquery.js">

</script>
@*<script type="text/javascript">

    $(document).ready(function () {
        $('button[class^="next"]').click(function () {
            $('#medicineId').val($(this).data('id'));
            $("#confirmationModal").modal('show');
        });
    });
</script>*@
<script type="text/javascript">
    $(document).ready(function() {
        $('#confirmationModal').on('show.bs.modal',
            function(event) {
                var button = $(event.relatedTarget); // Button that triggered the modal
                var medicineId = button.data('whatever'); // Extract info from data-* attributes
                // If necessary, you could initiate an AJAX request here (and then do the updating in a callback).
                // Update the modal's content. We'll use jQuery here, but you could use a data binding library or other methods instead.
                var modal = $(this);
                modal.find('.modal-title').text('New message to ' + medicineId);
                modal.find('.modal-body input').val(medicineId);
            });
    });
</script>
<!--Loops for displaying as much boxes as there are object in portfolio-->
<body>
@for (int i = 0; i < rowsCount; i++)
{
    <div class="row">
        @if (cellsRemaining >= 3)
        {
            for (int j = 0; j < 3; j++)
            {
                <div class="col-md-3">

                    @{
                        var index = 3 * i + j;
                        var med = listOfObjects[index];}
                    <h4>Ravim : @med.Name</h4>
                    <p>
                        @Html.HiddenFor(modelItem => med)
                        ATC: @med.AtcCode <br />
                        Manustamine: @med.FormOfInjection <br />
                        Soodustus: @med.LegalStatus <br />
                        Tugevuvs: @med.Strength <br />
                        @*<button type="button" class="next button1" onClick=@{ medView = med;}>Vajuta!</button>*@
                        <button type="button" class="button1" data-toggle="modal" data-target="#confirmationModal" data-whatever=@med.ID>Eemalda</button>

                    </p>
                </div>

                cellsRemaining -= 1;
            }
        }
        else
        {
            for (int j = 0; j < cellsRemaining; j++)
            {
                <div class="col-md-3">

                    @{
                        var index = 3 * i + j;
                        var med = listOfObjects[index];}

                    <h4>Ravim : @med.Name</h4>

                    <p>
                        @Html.HiddenFor(modelItem => med)
                        ATC: @med.AtcCode <br />
                        Manustamine: @med.FormOfInjection<br />
                        Soodustus: @med.LegalStatus<br />
                        Tugevuvs: @med.Strength <br />
                        <button type="button" class="button1" data-toggle="modal" data-target="#confirmationModal" data-whatever=@med.ID>Eemalda</button>
                    </p>
                </div>
            }
        }
    </div>
}
</body>
<div class="modal fade" id="confirmationModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">New message</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                @using (Html.BeginForm("RemoveMedicineFromPortfolio", "Portfolios"))
                {
                <div class="form-group">
                    <label for="recipient-name" class="col-form-label">Recipient:</label>
                    <input type="text" class="form-control hidden" id="medicineId">
                    <input type="submit" id="submit-form" class="hidden button1" />
                </div>
                }
                @*<form>
                    <div class="form-group">
                        <label for="recipient-name" class="col-form-label">Recipient:</label>
                        <input type="text" class="form-control" id="recipient-name">

                    </div>
                </form>*@
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Sulge</button>
                <label for="submit-form" class="btn btn-primary">Kinnita</label>
            </div>
        </div>
    </div>
</div>

@*<div>
    <fieldset>
        <div class="container">
            <div class="row">
                <div class="col-xs-12">
                    <div class="modal fade" tabindex="-1" id="confirmationModal"
                         data-keyboard="false" data-backdrop="static">
                        <div class="modal-dialog modal-lg">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <button type="button" class="close" data-dismiss="modal">
                                        ×
                                    </button>
                                    <h4 class="modal-title" class="">@medView.Name</h4>
                                </div>
                                <div class="modal-body">
                                    @medView.AtcCode
                                </div>
                                <div class="modal-footer">
                                    <button type="submit" name="button" value="prior" class="btn btn-primary button button4">Kinnita soovitus</button>
                                    <button type="button" id="btnHideConfirmation" class="btn btn-primary button button4">
                                        Katkesta
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </fieldset>
</div>*@


